<!DOCTYPE html><html id="top" lang="pt" data-theme="light"><head><meta name="viewport" content="width=device-width,initial-scale=1"><meta charset="utf-8"><title>Implementando uma classe em Python para criar logs | William Canin</title><script>if (window.top !== window.self) {
        // Prevents the site from being displayed inside an <iframe>
        window.top.location = window.self.location;
      }</script><meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        img-src 'self' data: https://www.google.com https://media0.giphy.com https://media4.giphy.com https://github.githubassets.com;
        script-src 'self' 'unsafe-inline'
          https://cdn.jsdelivr.net
          https://cdnjs.cloudflare.com
          https://giscus.app
        https://disqus.com;
        style-src 'self' 'unsafe-inline'
        https://cdnjs.cloudflare.com
        https://fonts.googleapis.com
        https://cdn.jsdelivr.net
        https://giscus.app
        https://disqus.com;
        font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com data:;
        connect-src 'self' https://www.google.com https://api.github.com;
        frame-src https://www.google.com https://www.youtube.com https://giscus.app https://disqus.com;
        object-src 'none';
        base-uri 'self';
        form-action 'self';
    "><meta http-equiv="Strict-Transport-Security" content="max-age=31536000; includeSubDomains; preload"><meta http-equiv="Cross-Origin-Opener-Policy" content="same-origin"><meta http-equiv="Cross-Origin-Embedder-Policy" content="require-corp"><link rel="icon" type="image/png" href="/assets/images/favicon.png"><link rel="apple-touch-icon" href="/assets/images/favicon.png"><title>Implementando uma classe em Python para criar logs | Hey, I‚Äôm William Canin</title><meta name="generator" content="Jekyll v4.4.1"><meta property="og:title" content="Implementando uma classe em Python para criar logs"><meta name="author" content="William C. Canin"><meta property="og:locale" content="pt"><meta name="description" content="Como criar logs utilizando Python? Talvez foi isso que voc√™ procurou na internet, e se est√° lendo, talvez voc√™ possa ter encontrado o que pesquisou"><meta property="og:description" content="Como criar logs utilizando Python? Talvez foi isso que voc√™ procurou na internet, e se est√° lendo, talvez voc√™ possa ter encontrado o que pesquisou"><link rel="canonical" href="https://williamcanin.github.io/blog/implementando-uma-classe-em-python-para-criar-logs/"><meta property="og:url" content="https://williamcanin.github.io/blog/implementando-uma-classe-em-python-para-criar-logs/"><meta property="og:site_name" content="Hey, I‚Äôm William Canin"><meta property="og:type" content="article"><meta property="article:published_time" content="2021-06-26T23:37:43+00:00"><meta name="twitter:card" content="summary"><meta property="twitter:title" content="Implementando uma classe em Python para criar logs"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"William C. Canin"},"dateModified":"2021-06-26T23:37:43+00:00","datePublished":"2021-06-26T23:37:43+00:00","description":"Como criar logs utilizando Python? Talvez foi isso que voc√™ procurou na internet, e se est√° lendo, talvez voc√™ possa ter encontrado o que pesquisou","headline":"Implementando uma classe em Python para criar logs","mainEntityOfPage":{"@type":"WebPage","@id":"https://williamcanin.github.io/blog/implementando-uma-classe-em-python-para-criar-logs/"},"url":"https://williamcanin.github.io/blog/implementando-uma-classe-em-python-para-criar-logs/"}</script><meta property="og:locale:alternate" content="en_US"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=SUSE+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;display=swap"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"><link rel="stylesheet" href="/assets/vendor/bootstrap/css/bootstrap.min.css"><script>(function() {
      const savedTheme = localStorage.getItem('theme') || 'light';
      document.documentElement.setAttribute('data-theme', savedTheme);
    })();</script><link rel="stylesheet" href="/assets/css/style.css"><link rel="alternate" type="application/atom+xml" title="Hey, I'm William Canin
" href="/feed.xml"></head><body data-layout="post" data-terminal-enabled="true"><div class="default" style="max-width: 800px !important;"><div class="modal fade" id="avatarModal" tabindex="-1" aria-hidden="true"><div class="modal-dialog modal-dialog-centered"><div class="modal-content bg-transparent border-0 shadow-none"><div class="modal-body d-flex justify-content-center"><img id="modalAvatar" class="avatar-img" src="" alt=""></div></div></div></div><header class="container header"><div class="header-wrapper"><div class="row"><div class="col-sm-2 d-flex flex-column justify-content-end"><div class="container"><div class="row"><span>[&nbsp;üè†&nbsp;<a class="" href="/">home</a>&nbsp;]</span></div></div></div><div class="col-sm-8 d-flex flex-column justify-content-end"><div class="container"><div class="row"><span class="title">Hey, I'm William Canin</span></div><div class="row"><small class="description">thoughts on programming, digital wellbeing, linux</small></div></div></div><div class="col-sm-2 d-flex justify-content-end avatar"><div class="avatar-wrapper"><div class="avatar-flipper light-theme can-flip"><div class="avatar-card"><div class="avatar-front"><img id="avatarImgLight" class="avatar-img" src="/assets/images/wcanin_light.png" alt="Hey, I'm William Canin
"></div><div class="avatar-back"><img class="avatar-img" src="/assets/images/wcanin_back.png" alt="Hey, I'm William Canin
"></div></div></div><div class="avatar-flipper dark-theme can-flip"><div class="avatar-card"><div class="avatar-front"><img id="avatarImgDark" class="avatar-img" src="/assets/images/wcanin_dark.png" alt="Hey, I'm William Canin
"></div><div class="avatar-back"><img class="avatar-img" src="/assets/images/wcanin_back.png" alt="Hey, I'm William Canin
"></div></div></div></div></div></div><div class="menu-separator"></div><div class="row"><div class="col-sm d-flex justify-content-center column-bottom"><span class="blog-menu">weblog&nbsp;¬ª üìù&nbsp;<a class="blog-menu__link" href="/blog/">posts</a><strong>&nbsp;.&nbsp;</strong>üîç&nbsp;<a id="blog-search__btn" class="blog-menu__link" href="/blog/?search=open">search</a><strong>&nbsp;.&nbsp;</strong>üè∑Ô∏è&nbsp;<a class="blog-menu__link" href="/blog/tags/">tags</a><strong>&nbsp;.&nbsp;</strong>üì∞&nbsp;<a class="blog-menu__link" href="/feed.xml">feed</a><strong>&nbsp;.&nbsp;</strong></span></div></div><div class="row justify-content-end"><div class="col-sm-2 d-flex justify-content-end"><span id="toggle-theme"><i class="fa-solid fa-moon"></i></span></div></div></div></header><main class="content"><article class="container post" itemscope itemtype="http://schema.org/BlogPosting"><div class="row"><header class="post-header"><h1 class="post-title p-name" itemprop="name headline">¬ª&nbsp;Implementando uma classe em Python para criar logs</h1><div class="row post-meta"><div class="col-sm d-flex justify-content-start"><time class="dt-published" datetime="2021-06-26T23:37:43+00:00" itemprop="datePublished">26 Jun, 2021</time></div><div class="col-sm d-flex justify-content-end"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">autor:&nbsp;William C. Canin</span></span></div><div class="post-reading_time">[&nbsp;Leia em cerca de 21 minutos&nbsp;]</div></div></header><div class="post-content e-content" itemprop="articleBody"><nav class="toc" id="toc" data-toc-selector=".post-content" data-toc-max-level="3" data-toc-scroll-offset="20"><div class="toc-head"><h2>√çndice</h2><button class="toc-toggle" aria-expanded="true" type="button">Fechar</button></div><div class="toc-list-wrapper"><ul class="toc-list" role="list"></ul><p class="toc-empty" style="display:none">No titles found. Remove TOC!</p></div></nav><script>(function () {
  const minLayoutWidth = 1830;

  const toc = document.getElementById('toc');
  if (toc) {
    const sentinel = document.createElement('div');
    toc.parentNode.insertBefore(sentinel, toc);

    function shouldApplyFixed() {
      return window.innerWidth > minLayoutWidth;
    }

    const observer = new IntersectionObserver(
      ([entry]) => {
        if (shouldApplyFixed()) {
          if (!entry.isIntersecting) {
            toc.classList.add('toc-fixed');
          } else {
            toc.classList.remove('toc-fixed');
          }
        } else {
          toc.classList.remove('toc-fixed');
        }
      },
      { threshold: 0 }
    );
    observer.observe(sentinel);

    window.addEventListener('resize', () => {
        if (!shouldApplyFixed()) {
            toc.classList.remove('toc-fixed');
        }
    });
  }

  function slugify(text) {
    if (!text) return '';
    return text.toString().toLowerCase().trim()
      .normalize('NFKD').replace(/[\u0300-\u036f]/g, '')
      .replace(/[^\w\s-]/g, '').replace(/\s+/g, '-').replace(/--+/g, '-');
  }

  function buildTOC(tocEl) {
    const selector = tocEl.dataset.tocSelector || '.post-content' || '.page-content';
    const maxLevel = parseInt(tocEl.dataset.tocMaxLevel || '3', 10);
    const offset = parseInt(tocEl.dataset.tocScrollOffset || '20', 10);
    const root = document.querySelector(selector);

    if (!root) {
      tocEl.querySelector('.toc-empty').textContent = `Content not found (${selector})`;
      tocEl.querySelector('.toc-empty').style.display = 'block';
      return;
    }

    const headings = Array.from(root.querySelectorAll(Array(maxLevel).fill(0).map((_, i) => `h${i + 1}`).join(',')))
      .filter(h => !tocEl.contains(h))
      .filter(h => parseInt(h.tagName.substring(1)) <= maxLevel);

    if (headings.length === 0) {
      tocEl.querySelector('.toc-empty').style.display = 'block';
      return;
    }

    const tocRoot = tocEl.querySelector('.toc-list');
    tocRoot.innerHTML = '';

    const idCounts = {};
    headings.forEach(h => {
      if (!h.id) {
        let id = slugify(h.textContent);
        if (!id) id = 'section';
        if (idCounts[id]) { idCounts[id] += 1; id = id + '-' + idCounts[id]; }
        else idCounts[id] = 1;
        h.id = id;
      }
    });

    // Build hierarchical tree
    const stack = [{ level: 0, ul: tocRoot }];
    headings.forEach((h, i) => {
      const level = parseInt(h.tagName.substring(1));
      const li = document.createElement('li');
      const a = document.createElement('a');
      a.href = '#' + h.id;
      a.textContent = h.textContent.trim();
      a.addEventListener('click', e => {
        e.preventDefault();
        window.scrollTo({ top: h.getBoundingClientRect().top + window.scrollY - offset, behavior: 'smooth' });
        history.replaceState(null, '', '#' + h.id);

        // // Clicking on the TOC menu closes the TOC
        // const wrapper = tocEl.querySelector('.toc-list-wrapper');
        // const toggle = tocEl.querySelector('.toc-toggle');
        // wrapper.style.display = 'none';
        // toggle.setAttribute('aria-expanded', 'false');
        // toggle.textContent = '{ { include.btn_show } }';
      });
      li.appendChild(a);

      while (stack.length > 1 && level <= stack[stack.length - 1].level) stack.pop();
      const parent = stack[stack.length - 1].ul;
      parent.appendChild(li);

      const next = headings[i + 1];
      if (next) {
        const nextLevel = parseInt(next.tagName.substring(1));
        if (nextLevel > level) {
          const newUl = document.createElement('ul');
          li.appendChild(newUl);
          stack.push({ level, ul: newUl });
        }
      }
    });

    // Active Highlight
    const links = tocRoot.querySelectorAll('a');
    function onScroll() {
      const fromTop = window.scrollY + offset + 1;
      let current = headings[0];
      for (let i = 0; i < headings.length; i++) {
        if (headings[i].offsetTop <= fromTop) current = headings[i];
      }
      links.forEach(l => l.classList.toggle('active', l.getAttribute('href') === '#' + current.id));
    }
    window.addEventListener('scroll', onScroll, { passive: true });
    onScroll();
  }

  document.addEventListener('DOMContentLoaded', function () {
    document.querySelectorAll('.toc').forEach(toc => {
      buildTOC(toc);
      const toggle = toc.querySelector('.toc-toggle');
      const wrapper = toc.querySelector('.toc-list-wrapper');

      wrapper.style.display = 'none';
      toggle.setAttribute('aria-expanded', 'false');
      toggle.textContent = 'Abrir';

      toggle.addEventListener('click', () => {
        const expanded = toggle.getAttribute('aria-expanded') === 'true';
        wrapper.style.display = expanded ? 'none' : 'block';
        toggle.setAttribute('aria-expanded', (!expanded).toString());
        toggle.textContent = expanded ? 'Abrir' : 'Fechar';
      });

      const tocTop = toc.offsetTop;

      function handleScrollFix() {
        if (window.innerWidth <= minLayoutWidth) {
          toc.classList.remove('fixed');
          toc.style.position = '';
          toc.style.top = '';
          toc.style.zIndex = '';
          toc.style.width = '';
          return;
        }

        const scrollTop = window.scrollY || document.documentElement.scrollTop;

        // Fixes pinning behavior in Chrome
        if (scrollTop >= tocTop) {
          toc.classList.add('fixed');
          toc.style.position = 'fixed';
          toc.style.top = '0';
          toc.style.zIndex = '9999';
          // toc.style.width = toc.offsetWidth + 'px';
        } else {
          toc.classList.remove('fixed');
          toc.style.position = '';
          toc.style.top = '';
          toc.style.width = '';
        }

        // // Automatically closes the TOC if it is open and scrolled to it.
        // const rect = toc.getBoundingClientRect();
        // if (rect.top <= 0 && toggle.getAttribute('aria-expanded') === 'true') {
        //   wrapper.style.display = 'none';
        //   toggle.setAttribute('aria-expanded', 'false');
        //   toggle.textContent = '{ { include.btn_show } }';
        // }
      }

      window.addEventListener('scroll', handleScrollFix, { passive: true });
      window.addEventListener('resize', handleScrollFix);
      handleScrollFix();
    });
  });
})();</script><p>Ol√° <img src="https://media.giphy.com/media/hvRJCLFzcasrR4ia7z/giphy.gif" width="25px">, bem vindo a mais um post no meu weblog. Vamos come√ßar a leitura?!</p><h1 id="introdu√ß√£o">Introdu√ß√£o</h1><p>Conforme voc√™ vai avan√ßando na programa√ß√£o, voc√™ vai se desafiando, e como isso criando aplica√ß√µes mais complexas e com necessidade de armazenar logs. Pensando nisso, resolvi criar esse post n√£o s√≥ pra quem vai fazer um software mais avan√ßado, mas tamb√©m serve para todos tipos de n√≠veis de aplica√ß√£o dependendo o que a mesma ir√° exigir.</p><p>Neste post voc√™ vai aprender de forma b√°sica como criar seus logs e ainda vamos implementar de uma forma que voc√™ possa usar como m√≥dulo para outros recursos, e um extra de colorir<code class="language-plaintext highlighter-rouge">*</code> as mensagens de logs.</p><p><strong>E por qu√™ eu digo aprender de forma simples?</strong></p><p>R:- Porque dependendo do que voc√™ tem em mente, criar um registro de log e onde ir√° armazenar esses logs, pode exigir que voc√™ tenha que lhe dar com permiss√µes de usu√°rio no diret√≥rio a ser gravado os logs (o que n√£o √© no caso que iremos abordar neste post). No Linux por exemplo, muitas aplica√ß√µes registram seus logs no diret√≥rio <code class="language-plaintext highlighter-rouge">/var/logs</code>, porem, isso √© uma conven√ß√£o e n√£o necessariamente voc√™ precisa registra-los nesse diret√≥rio, ou seja, vai de programador para programador.</p><p>Agora vamos de fato ‚Äúcodar‚Äù e sair dos avisos. Voil√°!</p><blockquote><p><code class="language-plaintext highlighter-rouge">*</code> O modo de colorir os logs deste post, s√≥ ser√° poss√≠vel se voc√™ estiver em um sistema Unix, ou seja, n√£o √© compat√≠vel com sistema Windows.</p></blockquote><h1 id="requisitos">Requisitos</h1><table><thead><tr><th>Softwares</th><th>Vers√£o</th><th>Onde obter?</th></tr></thead><tbody><tr><td>Python</td><td>&gt;= 3.5</td><td><a href="https://www.python.org/downloads/" target="_blank">Python Downloads</a></td></tr></tbody></table><p>E o mais importante, toda sua mega master aten√ß√£o de leitura. Que eu sei que voc√™. :D</p><h1 id="criando-o-m√≥dulo">Criando o m√≥dulo</h1><p>Bom, um m√≥dulo em Python nada mais √© que um arquivo contendo seu c√≥digo ent√£o vamos criar um arquivo chamado <strong>logger.py</strong>:</p><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">touch </span>logger.py</code></pre></figure><h1 id="implementando-o-c√≥digo">Implementando o c√≥digo</h1><h2 id="imports">Imports</h2><p>Com o arquivo <strong>logger.py</strong> criado; tudo come√ßa com os <code class="language-plaintext highlighter-rouge">imports</code>, ent√£o vamos fazer os imports que s√£o 2 (dois) apenas que iremos trabalhar:</p><figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
</pre></td><td class="code"><pre><span class="kn">import</span> <span class="n">logging</span>
<span class="kn">from</span> <span class="n">sys</span> <span class="kn">import</span> <span class="n">platform</span>
</pre></td></tr></tbody></table></code></pre></figure><p>O primeiro <em>import</em> √© o de fato o mais importante que √© o m√≥dulo <strong>logging</strong>, um m√≥dulo de logs nativo do Python. O segundo, o <a href="https://docs.python.org/pt-br/3.9/library/sys.html?highlight=platform#sys.platform" target="_blank"><strong>platform</strong></a> tamb√©m √© um m√≥dulo nativo do Python, mas que tem uma fun√ß√£o chamada <strong>startswith</strong>, que retorna um valor booleano atrav√©s do par√¢metro passado nela para verificar o tipo de plataforma do S.O.</p><h2 id="fun√ß√£o-para-verificar-sistema-operacional">Fun√ß√£o para verificar Sistema Operacional</h2><p>Como dito antes, iremos trabalhar com cor ANSI nos logs, mas precisamos verificar se estamos de fato em um sistema operacional que suporte isso, ent√£o vamos criar uma fun√ß√£o ‚Äúverificadora‚Äù.</p><figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="code"><pre><span class="k">def</span> <span class="nf">unix_color</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">platform</span><span class="p">.</span><span class="nf">startswith</span><span class="p">(</span><span class="sh">"</span><span class="s">win</span><span class="sh">"</span><span class="p">):</span>
        <span class="k">return</span> <span class="sh">""</span>
    <span class="k">return</span> <span class="n">value</span>
</pre></td></tr></tbody></table></code></pre></figure><p>Uma fun√ß√£o simples, que retorna uma string vazia caso o sistema operacional seja Windows, caso contr√°rio, me retorna o pr√≥prio valor passado no par√¢metro. Este valor passado por par√¢metro ser√° nosso c√≥digo ANSI de cores, que iremos implementar mais adiante.</p><h2 id="criando-classe-colors-para-armazenar-cores-ansi">Criando classe <code class="language-plaintext highlighter-rouge">Colors</code> para armazenar cores ANSI</h2><p>Agora chegou a hora de criarmos uma classe que ir√° armazenar nossas cores ANSI, essa classe ter√° apenas vari√°veis de classe:</p><blockquote><p>Criei um v√≠deo no <strong>YouTube</strong>, explicando como podemos criar um m√≥dulo para imprimir mensagens coloridas com Python. Se voc√™ n√£o visualizou vale a pena olhar, pois este c√≥digo √© um pequeno trecho que tirei deste v√≠deo. Voc√™ pode acessa-l√≥ <a href="https://www.youtube.com/watch?v=VW-UphhjJ3E&amp;feature=emb_imp_woyt" target="_blank">clicando aqui</a></p></blockquote><figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre><span class="k">class</span> <span class="nc">Colors</span><span class="p">:</span>
    <span class="n">NONE</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[0m</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">BLACK</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[30m</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">MAGENTA</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[95m</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">BLUE</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[94m</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">GREEN</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[92m</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">RED</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[91m</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">YELLOW</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[93m</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">CYAN</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[96m</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">WHITE</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[97m</span><span class="sh">"</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></figure><p>Repare que criei vari√°veis de classe, e os valores que elas est√£o recebendo est√° sendo atribuindo pela fun√ß√£o <strong>unix_color</strong> que criamos assim, ou seja, se o sistema operacional for UNIX, ir√° retornar o par√¢metro passado na fun√ß√£o, nas vari√°veis de classe.</p><p>Criei apenas alguns op√ß√µes de cores e estilos ANSI, mas voc√™ pode implementar mais acessando este <a href="https://en.wikipedia.org/wiki/ANSI_escape_code" target="_blank">documento</a> que contem explica√ß√µes mais detalhas sobre cores ANSI.</p><blockquote><p>NOTA: Tem como utilizar cores para Windows como a biblioteca <a href="https://pypi.org/project/colorama" target="_blank"><strong>colorama</strong></a> por exemplo, porem, est√° forma √© reconhecida apenas por sistemas baseado em UNIX (Linux e OS X).</p></blockquote><h2 id="criando-classe-de-logs">Criando classe de logs</h2><p>Vamos come√ßar de fato a criar nossa classe de <strong>logs</strong>, onde ser√° uma classe que ir√° herdar da classe <strong>Colors</strong>:</p><figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="code"><pre><span class="k">class</span> <span class="nc">Logs</span><span class="p">(</span><span class="n">Colors</span><span class="p">):</span>

    <span class="n">FILENAME</span> <span class="o">=</span> <span class="sh">"</span><span class="s">app.log</span><span class="sh">"</span>
    <span class="n">DATE_FORMAT</span> <span class="o">=</span> <span class="sh">"</span><span class="s">%m/%d/%Y %I:%M:%S %p</span><span class="sh">"</span>
</pre></td></tr></tbody></table></code></pre></figure><p>Repare que temos 2 (duas) vari√°veis de classe, a <strong>FILENAME</strong>, que recebe o nome com path (neste caso sem nenhum path) do arquivo de log que ir√° ser criado, e o <strong>DATE_FORMAT</strong>, que ser√° o formato da data a ser gravada nos logs. Voc√™ ir√° entender mais dessas duas vari√°veis de classe a seguir no m√©todo <strong>dander init</strong> (<code class="language-plaintext highlighter-rouge">__init__</code>).</p><h2 id="m√©todo-inicializador-construtor">M√©todo inicializador (‚Äúconstrutor‚Äù)</h2><p>No m√©todo <strong>dander init</strong> (<code class="language-plaintext highlighter-rouge">__init__</code>), vamos implementar a base do formato do nosso registrador de logs. Ent√£o, o m√©todo ser√° assim:</p><figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="code"><pre><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">FILENAME</span><span class="p">,</span> <span class="n">datefmt</span><span class="o">=</span><span class="n">DATE_FORMAT</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="n">self</span><span class="p">.</span><span class="n">date_format</span> <span class="o">=</span> <span class="n">datefmt</span>
        <span class="n">self</span><span class="p">.</span><span class="n">formated</span> <span class="o">=</span> <span class="sh">"</span><span class="s">%(levelname)s:[%(asctime)s]: %(message)s</span><span class="sh">"</span>

        <span class="n">self</span><span class="p">.</span><span class="n">levels</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">exception</span><span class="sh">"</span><span class="p">:</span> <span class="n">logging</span><span class="p">.</span><span class="n">exception</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">info</span><span class="sh">"</span><span class="p">:</span> <span class="n">logging</span><span class="p">.</span><span class="n">info</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">warning</span><span class="sh">"</span><span class="p">:</span> <span class="n">logging</span><span class="p">.</span><span class="n">warning</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">error</span><span class="sh">"</span><span class="p">:</span> <span class="n">logging</span><span class="p">.</span><span class="n">error</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">debug</span><span class="sh">"</span><span class="p">:</span> <span class="n">logging</span><span class="p">.</span><span class="n">debug</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">critical</span><span class="sh">"</span><span class="p">:</span> <span class="n">logging</span><span class="p">.</span><span class="n">critical</span>
        <span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></figure><p>Analisando nosso <code class="language-plaintext highlighter-rouge">__init__</code>, temos 2 (dois) par√¢metros no mesmo, o <code class="language-plaintext highlighter-rouge">filename</code> e <code class="language-plaintext highlighter-rouge">datefmt</code>. O <code class="language-plaintext highlighter-rouge">filaname</code> est√° recebendo por padr√£o, o valor da vari√°vel de classe <strong>FILENAME</strong>, assim como o <code class="language-plaintext highlighter-rouge">datefmt</code> tamb√©m. Implementamos essas par√¢metros justamente para o programador mudar o local de onde o registro de logs ser√° salvo e caso queira mudar o formato da data conforme a localidade em que est√°.</p><p>O <code class="language-plaintext highlighter-rouge">self.formated</code>, est√° recebendo um <a href="https://docs.python.org/pt-br/3.9/library/logging.html?highlight=logging#formatter-objects" target="_blank">formato</a> em que o m√≥dulo <code class="language-plaintext highlighter-rouge">logging</code> do Python suporta. Ele pode ter outras op√ß√µes, mas neste nosso caso implementamos 3, que s√£o:</p><ul><li>levelname - Registra o level do log.</li><li>asctime - Registra a data e hora do log.</li><li>message - Registra uma mensagem que ser√° passada por par√¢metro.</li></ul><p>O <code class="language-plaintext highlighter-rouge">self.levels</code> √© um dicion√°rio que est√° carregando os levels de log do m√≥dulo <code class="language-plaintext highlighter-rouge">logging</code>, √© muito importante observar que estamos carregando os levels sem ser <strong>Callable</strong>.</p><h2 id="m√©todo-de-registrar-os-logs">M√©todo de registrar os logs</h2><p>Agora come√ßa a nossa brincadeira, est√© m√©todo que ser√° respons√°vel por armazenar toda nossa l√≥gica para registrar os logs.</p><p>Vou implementar ele, e abaixo dele vou explicar o que cada condi√ß√£o e l√≥gica faz:</p><figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="code"><pre><span class="k">def</span> <span class="nf">record</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="sh">"</span><span class="s">exception</span><span class="sh">"</span><span class="p">,</span> <span class="n">colorize</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
          <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">levels</span><span class="p">.</span><span class="nf">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="nb">type</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">colorize</span><span class="p">:</span>
                    <span class="n">formated</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">formated</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="sh">"</span><span class="s">warning</span><span class="sh">"</span><span class="p">:</span>
                        <span class="n">formated</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">YELLOW</span><span class="si">}</span><span class="s">%(levelname)s:</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">GREEN</span><span class="si">}</span><span class="s">[%(asctime)s]</span><span class="sh">"</span>
                            <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">NONE</span><span class="si">}</span><span class="s">: %(message)s</span><span class="sh">"</span>
                        <span class="p">)</span>
                    <span class="k">elif</span> <span class="n">item</span> <span class="o">==</span> <span class="sh">"</span><span class="s">error</span><span class="sh">"</span> <span class="ow">or</span> <span class="n">item</span> <span class="o">==</span> <span class="sh">"</span><span class="s">exception</span><span class="sh">"</span><span class="p">:</span>
                        <span class="n">formated</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">RED</span><span class="si">}</span><span class="s">%(levelname)s:</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">GREEN</span><span class="si">}</span><span class="s">[%(asctime)s]</span><span class="sh">"</span>
                            <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">NONE</span><span class="si">}</span><span class="s">: %(message)s</span><span class="sh">"</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">formated</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">CYAN</span><span class="si">}</span><span class="s">%(levelname)s:</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">GREEN</span><span class="si">}</span><span class="s">[%(asctime)s]</span><span class="sh">"</span>
                            <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">NONE</span><span class="si">}</span><span class="s">: %(message)s</span><span class="sh">"</span>
                        <span class="p">)</span>
                <span class="n">logging</span><span class="p">.</span><span class="nf">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">formated</span><span class="p">,</span>
                                    <span class="n">datefmt</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">date_format</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="sh">"</span><span class="s">exception</span><span class="sh">"</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">levels</span><span class="p">[</span><span class="n">item</span><span class="p">](</span><span class="n">msg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="n">exc_info</span><span class="p">,</span>
                                             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">levels</span><span class="p">[</span><span class="n">item</span><span class="p">](</span><span class="n">msg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="sh">'</span><span class="s">Error implementing the method </span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">record</span><span class="p">.</span><span class="n">__name__</span><span class="si">}</span><span class="sh">"</span><span class="s"> in class Logs.</span><span class="sh">'</span>
            <span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></figure><h3 id="na-linha-1-√†-2">Na linha <code class="language-plaintext highlighter-rouge">1</code> √† <code class="language-plaintext highlighter-rouge">2</code></h3><p>Podemos observar que temos alguns par√¢metros no m√©todo <code class="language-plaintext highlighter-rouge">record</code>, eles s√£o:</p><ul><li>message - Este par√¢metro √© obrigat√≥rio, √© nele que iremos colocar nossa mensagem de log.</li><li>type - Este par√¢metro nomeado est√° como padr√£o o valor de uma string <strong>exception</strong>, isso significa que quando formos criar um log, se n√£o especificarmos o level que queremos de acordo com nosso dicion√°rio <code class="language-plaintext highlighter-rouge">self.levels</code>, ir√° ser registrado no level <code class="language-plaintext highlighter-rouge">exception</code>.</li><li>colorize - Par√¢metro booleano que se estiver <code class="language-plaintext highlighter-rouge">True</code>, nossos logs ser√£o coloridos.</li></ul><blockquote><p>NOTA: O log s√≥ ser√° mostrado colorido se carregarmos o arquivo de log pelo terminal, ent√£o, tenha em mente que se usar cores, ser√° chato ler esse arquivo em um editor de texto, por exemplo.</p></blockquote><p>Os par√¢metros <strong>exc_info</strong>, <strong>*args</strong> e <strong>**kwargs</strong>, est√£o sendo implementados porque as fun√ß√µes de level do m√≥dulo <code class="language-plaintext highlighter-rouge">logging</code>, <strong>exception</strong> e <strong>error</strong>, contem esses par√¢metro tamb√©m, e como nosso m√©todo <code class="language-plaintext highlighter-rouge">record</code> est√° sendo implementado em cima dessas fun√ß√µes de level, √© necess√°rio atribuir os mesmos argumentos.</p><h3 id="na-linha-3-√†-4">Na linha <code class="language-plaintext highlighter-rouge">3</code> √† <code class="language-plaintext highlighter-rouge">4</code></h3><p>Fazemos um <code class="language-plaintext highlighter-rouge">for</code> e nele contendo nossa primeira condi√ß√£o de <code class="language-plaintext highlighter-rouge">if</code>, que faz uma atribui√ß√£o de igualdade do tipo de level que ir√° ser usado atrav√©s do par√¢metro <code class="language-plaintext highlighter-rouge">type</code>.</p><h3 id="na-linha-5-√†-22">Na linha <code class="language-plaintext highlighter-rouge">5</code> √† <code class="language-plaintext highlighter-rouge">22</code></h3><p>Fazemos outra condi√ß√£o <code class="language-plaintext highlighter-rouge">if</code>, porem booleana. Se o par√¢metro <code class="language-plaintext highlighter-rouge">colorize</code> for <strong>False</strong>, ent√£o carregamos o formado padr√£o do nosso log especificado no m√©todo <code class="language-plaintext highlighter-rouge">__init__</code>, ou seja, carregamos o <code class="language-plaintext highlighter-rouge">self.formated</code>. Caso a condi√ß√£o seja <code class="language-plaintext highlighter-rouge">else</code>, carregamos outra condi√ß√£o de igualdade para verificar os levels e atribuir cores diferentes para cada um deles. Por exemplo, o level de <strong>Warning</strong> receber√° a cor <em>amarela</em>, o de <strong>Error</strong> e <strong>Exception</strong>, a cor <em>vermelha</em>, j√° o de <strong>Debug</strong>, <strong>Info</strong> e demais, receber√£o a cor <em>cyan</em>.</p><h3 id="na-linha-23-√†-24">Na linha <code class="language-plaintext highlighter-rouge">23</code> √† <code class="language-plaintext highlighter-rouge">24</code></h3><p>Aqui estamos aplicando as configura√ß√£o b√°sicas para nosso registro de logs atrav√©s da fun√ß√£o <code class="language-plaintext highlighter-rouge">basicConfig</code> do m√≥dulo <code class="language-plaintext highlighter-rouge">logging</code>. Repara que temos o par√¢metro <code class="language-plaintext highlighter-rouge">level</code> e estamos passando o level <code class="language-plaintext highlighter-rouge">INFO</code>. Precisamos passando algum level para este par√¢metro, sen√£o n√£o conseguimos criar nossos registros de log.</p><h3 id="na-linha-25-√†-29">Na linha <code class="language-plaintext highlighter-rouge">25</code> √† <code class="language-plaintext highlighter-rouge">29</code></h3><p>Nessas linhas estamos pegando os levels do meu dicion√°rio e aplicando um <em>Callable</em> com os par√¢metros necess√°rios. Estamos atribuindo uma condi√ß√£o e, se for do level <strong>exception</strong>, ir√° carregar um par√¢metro a mais, o <code class="language-plaintext highlighter-rouge">exc_info</code>.</p><h3 id="na-linha-30-√†-32">Na linha <code class="language-plaintext highlighter-rouge">30</code> √† <code class="language-plaintext highlighter-rouge">32</code></h3><p>Caso aconte√ßa de n√£o cair em nenhum retorno (<code class="language-plaintext highlighter-rouge">return</code>) ir√° disparar uma <strong>raise</strong> que imprimir√° uma mensagem ao usu√°rio de erro de implementa√ß√£o do m√©todo.</p><h2 id="c√≥digo-completo">C√≥digo completo</h2><p>Depois de destrinchar nosso c√≥digo por partes, obtemos o seguinte resultado do mesmo completo:</p><figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
</pre></td><td class="code"><pre><span class="kn">import</span> <span class="n">logging</span>
<span class="kn">from</span> <span class="n">sys</span> <span class="kn">import</span> <span class="n">platform</span>


<span class="k">def</span> <span class="nf">unix_color</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">platform</span><span class="p">.</span><span class="nf">startswith</span><span class="p">(</span><span class="sh">"</span><span class="s">win</span><span class="sh">"</span><span class="p">):</span>
        <span class="k">return</span> <span class="sh">""</span>
    <span class="k">return</span> <span class="n">value</span>


<span class="k">class</span> <span class="nc">Colors</span><span class="p">:</span>
    <span class="n">NONE</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[0m</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">BLACK</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[30m</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">MAGENTA</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[95m</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">BLUE</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[94m</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">GREEN</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[92m</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">RED</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[91m</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">YELLOW</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[93m</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">CYAN</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[96m</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">WHITE</span> <span class="o">=</span> <span class="nf">unix_color</span><span class="p">(</span><span class="sh">"</span><span class="se">\x1b</span><span class="s">[97m</span><span class="sh">"</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Logs</span><span class="p">(</span><span class="n">Colors</span><span class="p">):</span>

    <span class="n">FILENAME</span> <span class="o">=</span> <span class="sh">"</span><span class="s">mylogs.log</span><span class="sh">"</span>
    <span class="n">DATE_FORMAT</span> <span class="o">=</span> <span class="sh">"</span><span class="s">%m/%d/%Y %I:%M:%S %p</span><span class="sh">"</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">FILENAME</span><span class="p">,</span> <span class="n">datefmt</span><span class="o">=</span><span class="n">DATE_FORMAT</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="n">self</span><span class="p">.</span><span class="n">date_format</span> <span class="o">=</span> <span class="n">datefmt</span>
        <span class="n">self</span><span class="p">.</span><span class="n">formated</span> <span class="o">=</span> <span class="sh">"</span><span class="s">%(levelname)s:[%(asctime)s]: %(message)s</span><span class="sh">"</span>

        <span class="n">self</span><span class="p">.</span><span class="n">levels</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">exception</span><span class="sh">"</span><span class="p">:</span> <span class="n">logging</span><span class="p">.</span><span class="n">exception</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">info</span><span class="sh">"</span><span class="p">:</span> <span class="n">logging</span><span class="p">.</span><span class="n">info</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">warning</span><span class="sh">"</span><span class="p">:</span> <span class="n">logging</span><span class="p">.</span><span class="n">warning</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">error</span><span class="sh">"</span><span class="p">:</span> <span class="n">logging</span><span class="p">.</span><span class="n">error</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">debug</span><span class="sh">"</span><span class="p">:</span> <span class="n">logging</span><span class="p">.</span><span class="n">debug</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">critical</span><span class="sh">"</span><span class="p">:</span> <span class="n">logging</span><span class="p">.</span><span class="n">critical</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">record</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="sh">"</span><span class="s">exception</span><span class="sh">"</span><span class="p">,</span> <span class="n">colorize</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
               <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">levels</span><span class="p">.</span><span class="nf">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="nb">type</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">colorize</span><span class="p">:</span>
                    <span class="n">formated</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">formated</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="sh">"</span><span class="s">warning</span><span class="sh">"</span><span class="p">:</span>
                        <span class="n">formated</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">YELLOW</span><span class="si">}</span><span class="s">%(levelname)s:</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">GREEN</span><span class="si">}</span><span class="s">[%(asctime)s]</span><span class="sh">"</span>
                            <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">NONE</span><span class="si">}</span><span class="s">: %(message)s</span><span class="sh">"</span>
                        <span class="p">)</span>
                    <span class="k">elif</span> <span class="n">item</span> <span class="o">==</span> <span class="sh">"</span><span class="s">error</span><span class="sh">"</span> <span class="ow">or</span> <span class="n">item</span> <span class="o">==</span> <span class="sh">"</span><span class="s">exception</span><span class="sh">"</span><span class="p">:</span>
                        <span class="n">formated</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">RED</span><span class="si">}</span><span class="s">%(levelname)s:</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">GREEN</span><span class="si">}</span><span class="s">[%(asctime)s]</span><span class="sh">"</span>
                            <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">NONE</span><span class="si">}</span><span class="s">: %(message)s</span><span class="sh">"</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">formated</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">CYAN</span><span class="si">}</span><span class="s">%(levelname)s:</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">GREEN</span><span class="si">}</span><span class="s">[%(asctime)s]</span><span class="sh">"</span>
                            <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">NONE</span><span class="si">}</span><span class="s">: %(message)s</span><span class="sh">"</span>
                        <span class="p">)</span>
                <span class="n">logging</span><span class="p">.</span><span class="nf">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">formated</span><span class="p">,</span>
                                    <span class="n">datefmt</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">date_format</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="p">.</span><span class="n">INFO</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="sh">"</span><span class="s">exception</span><span class="sh">"</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">levels</span><span class="p">[</span><span class="n">item</span><span class="p">](</span><span class="n">msg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="n">exc_info</span><span class="p">,</span>
                                             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">levels</span><span class="p">[</span><span class="n">item</span><span class="p">](</span><span class="n">msg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="sh">'</span><span class="s">Error implementing the method </span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">record</span><span class="p">.</span><span class="n">__name__</span><span class="si">}</span><span class="sh">"</span><span class="s"> in class Logs.</span><span class="sh">'</span>
        <span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></figure><h2 id="como-usar">Como usar?</h2><p>Para fazer o uso √© muito f√°cil, apenas instancie a classe e passe os par√¢metros necess√°rios, e chamando a cria√ß√£o de logs atrav√©s de <strong>try/except</strong>.</p><p>Vamos fazer isso em um arquivo externo, criando com o nome de <strong>setup.py</strong> no mesmo diret√≥rio do <strong>logger.py</strong>:</p><figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">touch </span>setup.py</code></pre></figure><p>Agora vamos popular esse arquivo com o seguinte c√≥digo:</p><figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="code"><pre><span class="kn">from</span> <span class="n">logger</span> <span class="kn">import</span> <span class="n">Logs</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">logs</span> <span class="o">=</span> <span class="nc">Logs</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="sh">"</span><span class="s">calcs.log</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">n1</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="sh">"</span><span class="s">Digite o dividendo: </span><span class="sh">"</span><span class="p">))</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="sh">"</span><span class="s">Digite o divisor: </span><span class="sh">"</span><span class="p">))</span>
        <span class="n">result</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">O quociente √©: </span><span class="si">{</span><span class="n">n1</span> <span class="o">/</span> <span class="n">n2</span><span class="si">}</span><span class="sh">"</span>
        <span class="n">logs</span><span class="p">.</span><span class="nf">record</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="sh">"</span><span class="s">info</span><span class="sh">"</span><span class="p">,</span> <span class="n">colorize</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">ZeroDivisionError</span> <span class="k">as</span> <span class="n">text</span><span class="p">:</span>
        <span class="n">logs</span><span class="p">.</span><span class="nf">record</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">colorize</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">raise</span>
</pre></td></tr></tbody></table></code></pre></figure><p>Observe que est√° sendo atribuindo o registro de logs no <strong>try</strong> e no <strong>except</strong> porem, cada um deles com suas caracter√≠sticas.</p><p>No <strong>try</strong>, est√° sendo registrado um log apenas de informa√ß√£o, passando o valor <strong>info</strong> para par√¢metro <code class="language-plaintext highlighter-rouge">type</code>, onde a mensagem gravada √© o resultado da divis√£o.</p><p>No <strong>exception</strong>, n√£o temos o par√¢metro <code class="language-plaintext highlighter-rouge">type</code> porque ser√° registrado uma exce√ß√£o de erro, e o valor de <code class="language-plaintext highlighter-rouge">type</code> por padr√£o √© uma <em>exception</em>. Esta sendo gravado o texto de erro por divis√£o por zero (que n√£o existe). Tamb√©m usamos a palavr√£o <code class="language-plaintext highlighter-rouge">raise</code>, para estourar o erro na tela tamb√©m. Se tirarmos, apenas registrar√° o log.</p><h2 id="conclus√£o">Conclus√£o</h2><p>Esse foi um simples post com intuito de te dar um base de orienta√ß√£o sobre gravar registros de logs com Python. Lembre-se que isso n√£o √© tudo, voc√™ pode ver mais detalhes na documenta√ß√£o. Voc√™ pode acessar nos links abaixo que vou deixar. Espero que tenha gostado e at√© a pr√≥xima. :)</p><blockquote><p>Nota: Sempre veja a vers√£o da documenta√ß√£o antes de estudar.</p></blockquote><p><strong>Documenta√ß√£o:</strong></p><ul><li><a href="https://docs.python.org/pt-br/3/library/logging.html">https://docs.python.org/pt-br/3/library/logging.html</a></li></ul></div><div class="row post-tags"><ul class="tag-list"><strong>[ tags ]:</strong>&nbsp;&nbsp;<li class="tag-list__item"><a class="tag-list__link" href="/blog/tags/logs">logs</a></li><strong>&nbsp;&nbsp;.&nbsp;&nbsp;</strong><li class="tag-list__item"><a class="tag-list__link" href="/blog/tags/python">python</a></li><strong>&nbsp;&nbsp;.&nbsp;&nbsp;</strong></ul></div></div><div class="post-end text-center">/&nbsp;/&nbsp;/&nbsp;/&nbsp;&nbsp;end of post&nbsp;&nbsp;/&nbsp;/&nbsp;/&nbsp;/</div><div class="row comments"><h1 class="comments-title">[&nbsp;coment√°rios&nbsp;]</h1><div class="row comments-content"><script src="https://giscus.app/client.js" data-repo="williamcanin/williamcanin.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnk0MDMyOTUzOQ==" data-category-id="DIC_kwDOAmdhQ84CwLFu" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="noborder_light" data-lang="pt" crossorigin="anonymous" async></script></div></div><div class="row related-posts"><h3 class="related-posts-title">[&nbsp;postagens relacionadas&nbsp;]</h3><ul class="related-posts-list"><li class="related-posts-list__item"><span class="related-posts-list__meta">11 Dez, 2019</span>&nbsp;¬ª&nbsp;<a class="related-posts-list__link" href="/blog/criando-modulo-para-colorir-print-e-input-no-python/">Video - Criando m√≥dulo para colorir print e input no Python</a></li><li class="related-posts-list__item"><span class="related-posts-list__meta">02 Set, 2019</span>&nbsp;¬ª&nbsp;<a class="related-posts-list__link" href="/blog/manipulando-arquivo-json-com-python/">Video - Manipulando arquivo JSON com Python.</a></li><li class="related-posts-list__item"><span class="related-posts-list__meta">21 Jun, 2018</span>&nbsp;¬ª&nbsp;<a class="related-posts-list__link" href="/blog/instalando-python-automaticamente-em-qualquer-sistema-linux/">Instalando Python tarball em qualquer sistema Linux.</a></li></ul></div></article></main><footer class="container-fluid fixed-bottom footer"><div class="row top"><div class="col-md d-flex justify-content-end"><a id="top-link" class="top-link" href="#top">^</a></div></div><div class="row footer-wrapper"><div class="col-md footer-copyright-wrap"><div class="footer-copyright">¬©&nbsp;William Canin&nbsp;2015-2025&nbsp;-&nbsp;Todos os direitos reservados</div></div><div class="col-md footer-message-wrap"><div class="footer-message">Doing stuff on the web since 2007</div></div><div class="col-md footer-made-by-wrap"><div class="footer-made-by">Using the <a href="https://github.com/williamcanin/rawfeed" target="_blank" rel="noopener noreferrer">rawfeed</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener noreferrer">Jekyll</a>.</div></div></div></footer></div></body><script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script><script>window.giscusThemes = {
      light: "noborder_light",
      dark: "noborder_gray"
    };</script><script src="/assets/js/default.js"></script></html>