document.addEventListener("DOMContentLoaded",()=>{const a=document.getElementById("contactForm"),o=document.getElementById("submitButton"),l="https://script.google.com/macros/s/AKfycbySoGUfJlruD_X27cfOKuQ-BUTtfo9I2gDdsjkpRJikXhrJAiNFrd9Okwnc4w6zOXjuhQ/exec";function t(n,d,r="success"){const s=document.getElementById("contactMessageModal"),c=s.querySelector(".modal-title"),i=s.querySelector(".modal-body"),e=s.querySelector(".modal-content");e.classList.remove("contact-message-success","contact-message-error","contact-message-warning"),r==="success"?e.classList.add("contact-message-success"):r==="error"?e.classList.add("contact-message-error"):r==="warning"&&e.classList.add("contact-message-warning"),c.innerHTML=n,i.innerHTML=d,new bootstrap.Modal(s).show()}a.addEventListener("submit",async n=>{if(n.preventDefault(),!grecaptcha.getResponse()){t("Aviso","Por favor, marque a caixa 'N\xE3o sou um rob\xF4'.","warning");return}if(document.getElementById("textMessage").value.trim().length<"50"){t("Aviso","A mensagem deve ter pelo menos 50 caracteres.","warning");return}o.disabled=!0,o.textContent="Enviando...";const c=new FormData(a),i=Object.fromEntries(c.entries());try{const m=await(await fetch(l,{method:"POST",redirect:"follow",body:JSON.stringify(i)})).json();if(m.result==="success")a.reset(),grecaptcha.reset(),t("Mensagem enviada","Sua mensagem foi enviada com sucesso!","success");else throw t("Erro","Ocorreu um erro ao enviar sua mensagem.","error"),new Error(m.message||"Ocorreu um erro ao enviar sua mensagem.")}catch(e){console.error("Error sending:",e),e.message.includes("reCAPTCHA")?t("Erro","A verifica\xE7\xE3o falhou. Recarregue a p\xE1gina e tente novamente.","error"):t("Erro","Ocorreu um erro ao enviar a mensagem. Por favor, tente novamente.","error"),grecaptcha.reset()}finally{o.disabled=!1,o.textContent="Enviar!"}})});
