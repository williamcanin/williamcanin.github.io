document.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("contactForm");if(o){let t=function(n,d,a="success"){const s=document.getElementById("contactMessageModal"),c=s.querySelector(".modal-title"),i=s.querySelector(".modal-body"),e=s.querySelector(".modal-content");e.classList.remove("contact-message-success","contact-message-error","contact-message-warning"),a==="success"?e.classList.add("contact-message-success"):a==="error"?e.classList.add("contact-message-error"):a==="warning"&&e.classList.add("contact-message-warning"),c.innerHTML=n,i.innerHTML=d,new bootstrap.Modal(s).show()};const r=document.getElementById("submitButton"),l="https://script.google.com/macros/s/AKfycbySoGUfJlruD_X27cfOKuQ-BUTtfo9I2gDdsjkpRJikXhrJAiNFrd9Okwnc4w6zOXjuhQ/exec";o.addEventListener("submit",async n=>{if(n.preventDefault(),!grecaptcha.getResponse()){t("Aviso","Por favor, marque a caixa 'N\xE3o sou um rob\xF4'.","warning");return}if(document.getElementById("textMessage").value.trim().length<"50"){t("Aviso","A mensagem deve ter pelo menos 50 caracteres.","warning");return}r.disabled=!0,r.textContent="Enviando...";const c=new FormData(o),i=Object.fromEntries(c.entries());try{const m=await(await fetch(l,{method:"POST",redirect:"follow",body:JSON.stringify(i)})).json();if(m.result==="success")o.reset(),grecaptcha.reset(),t("Mensagem enviada","Sua mensagem foi enviada com sucesso!","success");else throw t("Erro","Ocorreu um erro ao enviar sua mensagem.","error"),new Error(m.message||"Ocorreu um erro ao enviar sua mensagem.")}catch(e){console.error("Error sending:",e),e.message.includes("reCAPTCHA")?t("Erro","A verifica\xE7\xE3o falhou. Recarregue a p\xE1gina e tente novamente.","error"):t("Erro","Ocorreu um erro ao enviar a mensagem. Por favor, tente novamente.","error"),grecaptcha.reset()}finally{r.disabled=!1,r.textContent="Enviar!"}})}});
