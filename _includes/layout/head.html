{%- include layout/data.liquid -%}

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8">
  {%- if page.url == "/" -%}
    <title>{{ site.title | default: theme_name }} | {{ site.baseurl | prepend: site.url }}</title>
  {%- else -%}
    <title>{{ page.title }} | {{ site.title | default: theme_name }}</title>
  {%- endif -%}

  {% comment %} Security {% endcomment %}
  {%- if jekyll.environment == 'production' %}
    {% comment %} { %- include layout/capture_scripts.liquid -% } {% endcomment %}

    <script>
      if (window.top !== window.self) {
        // Prevents the site from being displayed inside an <iframe>
        window.top.location = window.self.location;
      }
    </script>
    <!-- TODO: Colocar os script inline <script> todos em .js para evistar o uso de 'unsafe-inline' em script-src -->
    <meta http-equiv="Content-Security-Policy"
      content="
        default-src 'self';
        img-src 'self' data: {{ site.csp.img-src | join: ' ' }};
        script-src 'self' 'unsafe-inline'
        {{ site.csp.script-src | join: ' ' }}
        https://www.gstatic.com
        https://cdn.jsdelivr.net
        https://cdnjs.cloudflare.com
        https://giscus.app
        https://disqus.com;
        style-src 'self' 'unsafe-inline'
        https://cdnjs.cloudflare.com
        https://fonts.googleapis.com
        https://cdn.jsdelivr.net
        https://giscus.app
        https://disqus.com;
        font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com data:;
        connect-src 'self' {{ site.csp.connect-src | join: ' ' }};
        frame-src {{ site.csp.frame-src | join: ' ' }};
        object-src 'none';
        base-uri 'self';
        form-action 'self';
    ">
    <!-- ⚠️ CSP,HSTS,COOP and enabled in the theme, remember to also configure it in Cloudflare or your server -->
    <meta http-equiv="Strict-Transport-Security" content="max-age=31536000; includeSubDomains; preload">
    <meta http-equiv="Cross-Origin-Opener-Policy" content="same-origin">
    <meta http-equiv="Cross-Origin-Embedder-Policy" content="require-corp">
    <!-- ⚠️ CSP,HSTS,COOP enabled in the theme, remember to also configure it in Cloudflare or your server -->
  {%- endif -%}

  {% comment %} favicon {% endcomment %}
  <link rel="icon" type="image/png" href="{{ '/assets/images/favicon.png' | relative_url }}">
  <link rel="apple-touch-icon" href="{{ '/assets/images/favicon.png' | relative_url }}">

  {% comment %} SEO (jekyll-seo-tag) {% endcomment %}
  {%- seo -%}
  <meta property="og:locale:alternate" content="en_US">

  {%- if site.google.site_verification != "" -%}
    <!-- Google Site Verification -->
    <meta name="google-site-verification" content="{{ site.google.site_verification }}">
    <!-- Google Site Verification -->
  {%- endif -%}

  {% comment %} Fonts {% endcomment %}
  {%- comment -%}
  TODO: version: 0.2.0: place fonts used in the project instead of using Google Fonts.
  {%- endcomment -%}
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=SUSE+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;display=swap">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>

  {% comment %} bootstrap {% endcomment %}
  <link rel="stylesheet" href="{{ '/assets/vendor/bootstrap/css/bootstrap.min.css' | relative_url }}">

  {% comment %} fixes FOUC/flicker in firefox {% endcomment %}
  <script>
    (function() {
      const savedTheme = localStorage.getItem('theme') || 'light';
      document.documentElement.setAttribute('data-theme', savedTheme);
    })();
  </script>

  {% comment %} load theme {% endcomment %}
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
  <link rel="stylesheet" href="{{ '/assets/css/custom.css' | relative_url }}">

  {% comment %} feed {% endcomment %}
  <link rel="alternate" type="application/atom+xml" title="{{ site.title }}" href="{{ '/feed.xml' | relative_url }}">

  {%- if jekyll.environment == 'production' and site.google.analytics.enable == true and site.google.analytics.id != "" -%}
    <!-- Google Analytics -->
    {%- include google_analytics.html -%}
    <!-- Google Analytics -->
  {%- endif -%}
</head>
