{%- include layout/data.liquid -%}

{%- assign index = site.pages | where: "path", "index.md" | first -%}

{%- for item in site.defaults -%}
  {%- if item.scope.path == "_posts" -%}
    {%- assign blog_page = item.values.published -%}
  {%- endif -%}
  {%- if item.scope.path == "_pixels" -%}
    {%- assign pixels_page = item.values.published -%}
  {%- endif -%}
{%- endfor -%}

{%- assign menu_separator = default_.separator -%}

<!-- modal avatar -->
<div class="modal fade" id="avatarModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content bg-transparent border-0 shadow-none">
      <div class="modal-body d-flex justify-content-center">
        <img id="modalAvatar" class="avatar-img{% if default_.rounding %} rounding{% endif %}" src="" alt="">
      </div>
    </div>
  </div>
</div>
<!-- modal avatar -->

<header class="header" style="max-width: {{ header_.width | default: "860" }}px !important; font-family: {{ default_.font.style }} !important; font-size: {{ default_.font.size }} !important; letter-spacing:{{ default_.font.spacing }} !important;">
  <div class="row ">

    <!-- column home -->
    <div class="col-sm-3 d-flex flex-column justify-content-end header__column-home">
      {%- if index.layout == "blog" -%}
        <span>[{{ header_.menu.home.emoji | with_class: "spacer" }}<a class="{% if page.url == "/" or page.url == "/index.html" %}menu-active{% endif %}" href="{{home_url}}">{{ header_.menu.blog.title | default: "blog" | downcase }}</a>&nbsp;]</span>
      {%- else -%}
        <span>[{{ header_.menu.home.emoji | with_class: "spacer" }}<a class="{% if page.url == "/" or page.url == "/index.html" %}menu-active{% endif %}" href="{{home_url}}">{{ header_.menu.home.title | default: "home" | downcase }}</a>&nbsp;]</span>
      {%- endif -%}
    </div>
    <!-- column home -->

    <!-- column description -->
    <div class="col-sm-6 d-flex flex-column justify-content-end">
      <span class="title">{{ header_.title | default: theme_name }}</span>
      <small class="description">
        {{ header_.description | default: "A raw Jekyll theme for minimalists" }}
      </small>
    </div>
    <!-- column description -->

    <!-- column avatar -->
    <div class="col-sm-3 d-flex justify-content-end avatar">
      {%- assign images_ = site.static_files | map: "path" -%}
      {%- assign avatar_path_light = "/assets/images/" | append: header_.avatar.image.front.light -%}
      {%- assign avatar_path_dark = "/assets/images/" | append: header_.avatar.image.front.dark -%}
      {%- assign avatar_path_back = "/assets/images/" | append: header_.avatar.image.back -%}

      {%- if images_ contains avatar_path_light and images_ contains avatar_path_dark and images_ contains avatar_path_back -%}
        <div class="avatar-wrapper">

          <div class="avatar-flipper light-theme {% if header_.avatar.open %}avatar-flipper__open-true{% endif %}{% if header_.avatar.flip %} can-flip{% endif %}">
            <div class="avatar-card">
              <div class="avatar-front">
                <img id="avatarImgLight" class="avatar-img{% if default_.rounding %} rounding{% endif %}" src="{{ avatar_path_light | relative_url }}" alt="{{ site_title }}">
              </div>
              <div class="avatar-back">
                <img class="avatar-img{% if default_.rounding %} rounding{% endif %}" src="{{ avatar_path_back | relative_url }}" alt="{{ site_title }}">
              </div>
            </div>
          </div>

          <div class="avatar-flipper dark-theme {% if header_.avatar.open %} avatar-flipper__open-true{% endif %}{% if header_.avatar.flip %} can-flip{% endif %}">
            <div class="avatar-card">
              <div class="avatar-front">
                <img id="avatarImgDark" class="avatar-img{% if default_.rounding %} rounding{% endif %}" src="{{ avatar_path_dark | relative_url }}" alt="{{ site_title }}">
              </div>
              <div class="avatar-back">
                <img class="avatar-img{% if default_.rounding %} rounding{% endif %}" src="{{ avatar_path_back | relative_url }}" alt="{{ site_title }}">
              </div>
            </div>
          </div>

        </div>
      {%- endif -%}
    </div>
    <!-- column avatar -->

  </div>

  <!-- row separator -->
  <div class="row ">
    <div class="col-sm d-flex justify-content-center">
      <div class="line-separator"></div>
    </div>
  </div>
  <!-- row separator -->

  <!-- row menu -->
  <div class="row">
    <div class="col-sm d-flex justify-content-center menu">
      {%- if index.layout == "blog" -%}
        <div>
          {{ header_.menu.title }}&nbsp;»&nbsp;<div class="menu-wrap-link">{{ header_.menu.blog.search.emoji | with_class: "spacer" }}{%- if blog_.search.enable -%}<a id="blog-search__btn" href="{{search_url}}">{{ header_.menu.blog.search.title | default: "search" }}</a><strong class="separator">{{menu_separator}}</strong>{%- endif -%}</div><div class="menu-wrap-link">{{ header_.menu.blog.tags.emoji | with_class: "spacer" }}<a class="{% if page.url == "/blog/tags/" or page.url == "/blog/tags/index.html" %} menu-active{% endif %}" href="{{tags_url}}">{{ header_.menu.blog.tags.title | default: "tags" }}</a><strong class="separator">{{menu_separator}}</strong></div>
          {%- assign sorted_pages = site.pages | sort: 'order' -%}
            {%- for item in sorted_pages -%}
              {%- if item.path contains '_pages/' and item.published != false and item.in_menu -%}
                {%- unless item.url contains "/tags/" or item.url contains "404.html" -%}
                  <div class="menu-wrap-link">{{ item.emoji | with_class: "spacer" }}<a class="{% if page.url == item.url %}menu-active{% endif %}" href="{{ item.url | relative_url }}">{{ item.title | downcase }}</a><strong class="separator">{{menu_separator}}</strong></div>
                {%- endunless -%}
              {%- endif -%}
            {%- endfor -%}
            <div class="menu-wrap-link">{{ header_.menu.blog.feed.emoji | with_class: "spacer" }}<a href="{{feed_url}}">{{ header_.menu.blog.feed.title | default: "feed" }}</a><strong class="separator">{{menu_separator}}</strong></div>
        </div>
      {%- else index.layout == "home" -%}
        {%- if page.url contains "/blog/" -%}
          <div>
          {{ header_.menu.blog.title | replace: "/", "" | replace: "ls ", "" }}&nbsp;»
            <div class="menu-wrap-link">{{ header_.menu.blog.emoji | with_class: "spacer" }}<a class="{% if page.url == "/blog/" or page.url == "/blog/index.html" or page.url contains "/blog/page/" %} menu-active{% endif %}" href="{{blog_url}}">{{ header_.menu.blog.subtitle }}</a><strong class="separator">{{menu_separator}}</strong></div>{%- if blog_.search.enable -%}<span style="display: inline-block;">{{ header_.menu.blog.search.emoji | with_class: "spacer" }}<a id="blog-search__btn" href="{{search_url}}">{{ header_.menu.blog.search.title | default: "search" }}</a><strong class="separator">{{menu_separator}}</strong></span>{%- endif -%}<div class="menu-wrap-link">{{ header_.menu.blog.tags.emoji | with_class: "spacer" }}<a class="{% if page.url == "/blog/tags/" or page.url == "/blog/tags/index.html" %} menu-active{% endif %}" href="{{tags_url}}">{{ header_.menu.blog.tags.title | default: "tags" }}</a><strong class="separator">{{menu_separator}}</strong></div><div class="menu-wrap-link">{{ header_.menu.blog.feed.emoji | with_class: "spacer" }}<a href="{{feed_url}}">{{ header_.menu.blog.feed.title | default: "feed" }}</a><strong class="separator">{{menu_separator}}</strong></div>
          </div>
        {%- else -%}
          <div>
            {%- assign published_pages = site.pages | where_exp:"p","p.path contains '_pages/' and p.published" -%}
            {%- if published_pages.size > 0 -%}
              <span>{{ header_.menu.title }}&nbsp;»</span>&nbsp;
            {%- endif -%}
            {%- if site.pagination.enabled == true -%}
              {%- if blog_page -%}
              <div class="menu-wrap-link">{{ header_.menu.blog.emoji | with_class: "spacer" }}<a href="{{blog_url}}">{{ header_.menu.blog.title |  replace: "ls ", "" }}</a><strong class="separator">{{menu_separator}}</strong></div>
              {%- endif -%}
              {%- if pixels_page -%}
              <div class="menu-wrap-link">{{ header_.menu.pixels.emoji | with_class: "spacer" }}<a href="{{pixels_url}}">{{ header_.menu.pixels.title }}</a><strong class="separator">{{menu_separator}}</strong></div>
              {%- endif -%}{% assign sorted_pages = site.pages | sort: 'order' %}
              {%- for item in sorted_pages -%}
                {%- if item.path contains '_pages/' and item.in_menu -%}
                  {%- unless item.url contains "blog" or item.url contains "404.html" -%}
                    <div class="menu-wrap-link">{{ item.emoji | with_class: "spacer" }}<a class="{% if page.url == item.url %}menu-active{% endif %}" href="{{ item.url | relative_url }}">{{ item.title | downcase }}</a><strong class="separator">{{menu_separator}}</strong></div>
                  {%- endunless -%}
                {%- endif -%}
              {%- endfor -%}
            {%- else -%}
              {%- if blog_page -%}
                <div class="menu-wrap-link">{{ header_.menu.blog.emoji | with_class: "spacer" }}<a href="{{blog_url}}">{{ header_.menu.blog.title | replace: "/", "" }}</a><strong class="separator">{{menu_separator}}</strong></div>
              {%- endif -%}
              {%- if pixels_page -%}
              <div class="menu-wrap-link">{{ header_.menu.pixels.emoji | with_class: "spacer" }}<a href="{{pixels_url}}">pixels</a><strong class="separator">{{menu_separator}}</strong></div>
              {%- endif -%}{% assign sorted_pages = site.pages | sort: 'order' %}
              {%- for item in sorted_pages -%}
                {%- if item.path contains '_pages/' and item.published != false and item.in_menu -%}
                  {%- unless item.url contains "/tags/" or item.url contains "404.html" -%}
                    <div class="menu-wrap-link">{{ item.emoji | with_class: "spacer" }}<a class="{% if page.url == item.url %}menu-active{% endif %}" href="{{ item.url | relative_url }}">{{ item.title | downcase }}</a><strong class="separator">{{menu_separator}}</strong></div>
                  {%- endunless -%}
                {%- endif -%}
              {%- endfor -%}
            {%- endif -%}
          </div>
        {%- endif -%}
      {%- endif -%}
    </div>
  </div>
  <!-- row menu -->

  <!-- row button light/dark -->
  <div class="row justify-content-end">
    <div class="col-sm-2 d-flex justify-content-end">
      <span id="toggle-theme"><i class="fa-solid fa-moon"></i></span>
    </div>
  </div>
  <!-- row button light/dark -->

</header>
